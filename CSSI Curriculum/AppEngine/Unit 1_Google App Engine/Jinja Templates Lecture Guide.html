<!DOCTYPE html>
<!-- saved from url=(0067)https://cssicurriculum.withgoogle.com/mvc-appEngine/templating.html -->
<html class="gr__cssicurriculum_withgoogle_com mdl-js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width, initial-scale=1" name="viewport"><title>Jinja Templates Lecture Guide</title><meta content="
          
              Jinja Templates Lecture Guide
          " name="description"><link href="https://cssicurriculum.withgoogle.com/favicon.ico" rel="shortcut icon"><link href="./Jinja Templates Lecture Guide_files/material.indigo-yellow.min.css" rel="stylesheet"><link href="./Jinja Templates Lecture Guide_files/icon" rel="stylesheet"><script async="" src="./Jinja Templates Lecture Guide_files/analytics.js.download"></script><script defer="" src="./Jinja Templates Lecture Guide_files/material.min.js.download"></script><style>html,body{font-family:'Roboto','Helvetica',sans-serif;margin:0;padding:0}#verification_sent{display:None}.cssix-intro.mdl-card{width:99%;margin-bottom:2em}.cssix-intro.mdl-card>.mdl-card__supporting_text{padding:1em}.mdl-layout__header-row h3 a{color:white;text-decoration:none}#cssilogo_header{content:url('/cssilogo.png');width:80%}.admin_nav_link{color:red}.mdl-cssix .mdl-layout__header-row{padding-left:40px}.mdl-cssix .mdl-layout.is-small-screen .mdl-layout__header-row h3{font-size:inherit;padding-left:12px}.mdl-cssix .mdl-layout__tab-bar-button{display:none}.mdl-cssix .mdl-layout.is-small-screen .mdl-layout__tab-bar .mdl-button{display:none}.mdl-cssix .mdl-layout:not(.is-small-screen) .mdl-layout__tab-bar,.mdl-cssix .mdl-layout:not(.is-small-screen) .mdl-layout__tab-bar-container{overflow:visible}.cssi-main{overflow-x:visible!important;overflow-y:visible!important;overflow:visible!important}.mdl-cssix .mdl-layout__tab-bar-container{height:64px}.mdl-cssix .mdl-layout__tab-bar{padding:0;padding-left:16px;box-sizing:border-box;height:100%;width:100%}.mdl-cssix .mdl-layout__tab-bar .mdl-layout__tab{height:64px;line-height:64px;color:white}.mdl-cssix .mdl-layout__tab-bar .mdl-layout__tab.is-active::after{height:4px}.mdl-cssix main>.mdl-layout__tab-panel{padding:8px;padding-top:48px}.mdl-layout__tab#header_logout{background-color:red}.mdl-cssix .mdl-card{height:auto;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.mdl-cssix .mdl-card>*{height:auto}.mdl-cssix .mdl-card .mdl-card__supporting-text{margin:40px;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;padding:0;color:inherit;width:calc(100% - 80px)}.mdl-cssix .mdl-card__supporting-text h4{margin-top:0;margin-bottom:20px}.mdl-cssix .mdl-card__actions{margin:0;padding:4px 40px;color:inherit}.mdl-cssix .mdl-card__actions a{color:#00BCD4;margin:0}.mdl-cssix .mdl-card__actions a:hover,.mdl-cssix .mdl-card__actions a:active{color:inherit;background-color:transparent}.mdl-cssix .mdl-card__supporting-text+.mdl-card__actions{border-top:1px solid rgba(0,0,0,0.12)}.mdl-cssix #add{position:absolute;right:40px;top:36px;z-index:999}.mdl-list__item{min-height:.4em;padding:.3em}.material-icons.md-18{font-size:18px}.material-icons.md-24{font-size:24px}.material-icons.md-36{font-size:36px}.material-icons.md-48{font-size:48px}.post-list .toc_icon{vertical-align:middle;margin:.1em 1em}.mdl-cssix .mdl-layout__content section:not(:last-of-type){position:relative;margin-bottom:48px}.mdl-cssix section.section--center{max-width:860px}.mdl-cssix #features section.section--center{max-width:620px}.mdl-cssix section>header{display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.mdl-cssix section>.section__play-btn{min-height:200px}.mdl-cssix section>header>.material-icons{font-size:3rem}.mdl-cssix section>button{position:absolute;z-index:99;top:8px;right:8px}.mdl-cssix section .section__circle{display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;-webkit-flex-shrink:1;-ms-flex-negative:1;flex-shrink:1}.mdl-cssix section .section__text{-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;padding-top:8px}.mdl-cssix section .section__text h5{font-size:inherit;margin:0;margin-bottom:.5em}.mdl-cssix section .section__text a{text-decoration:none}.mdl-cssix section .section__circle-container>.section__circle-container__circle{width:64px;height:64px;border-radius:32px;margin:8px 0}.mdl-cssix section.section--footer .section__circle--big{width:100px;height:100px;border-radius:50px;margin:8px 32px}.mdl-cssix .is-small-screen section.section--footer .section__circle--big{width:50px;height:50px;border-radius:25px;margin:8px 16px}.mdl-cssix section.section--footer{padding:64px 0;margin:0 -8px -8px -8px}.mdl-cssix section.section--center .section__text:not(:last-child){border-bottom:1px solid rgba(0,0,0,.13)}.mdl-cssix .mdl-card .mdl-card__supporting-text>h3:first-child{margin-bottom:24px}.mdl-cssix .mdl-layout__tab-panel:not(#overview){background-color:white}.mdl-cssix #features section{margin-bottom:72px}.mdl-cssix #features h4,#features h5{margin-bottom:16px}.mdl-cssix .toc{border-left:4px solid #C1EEF4;margin:24px;padding:0;padding-left:8px;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.mdl-cssix .toc h4{font-size:.9rem;margin-top:0}.mdl-cssix .toc a{color:#4DD0E1;text-decoration:none;font-size:16px;line-height:28px;display:block}.mdl-cssix .mdl-menu__container{z-index:99}.cssix-content{border-radius:2px;padding:80px 56px;margin-bottom:16px}.is-small-screen .cssix-content{padding:0 8px 16px 12px}.cssix-content a{color:#03a9f4!important}div.instructor{border:2px solid red;border-radius:12px;padding:10px}div.instructor::before{content:"Instructor Notes(The students will not see this content):";display:block;color:red;font-weight:bold}a.instructor-notes-link{color:green!important}div.unpublished{border:2px solid green;border-radius:12px;padding:10px;background-color:#deffd1}div.unpublished::before{content:"This content is not released to students yet";color:red;font-weight:bold}a.unpublished-link{color:red!important}a.next{float:right}.post-content img{width:50%;display:block;margin:auto}.post-content img.large_img{width:80%;display:block;margin:auto}.is-small-screen .mdl-layout__tab-bar-container{display:none}.mdl-layout.is-upgraded .mdl-layout__tab.is-active{color:yellow;font-weight:bold}.mdl-layout__tab.admin_link{background-color:#c71414}.mdl-layout__header .mdl-layout__drawer-button{color:yellow!important}. .mdl-mini-footer{border-top:1px solid #ccc;background-color:inherit!important;padding:8px 16px}footer .lockup{padding-left:15px;padding-top:10px}.lockup-logo,.lockup-text{display:inline-block}.va{vertical-align:middle;line-height:0}.lockup-logo{width:74px;height:24px;background-image:url(https://www.gstatic.com/images/branding/googlelogo/1x/googlelogo_color_74x24dp.png);background-size:74px 24px}.lockup-logo.lockup-dark{background-image:url(https://www.gstatic.com/images/branding/googlelogo/1x/googlelogo_dark_color_74x24dp.png);opacity:.54}@media(max-width:760px){footer .lockup{padding-top:0}}.answer{display:none;border:2px solid green;border-radius:12px;padding:1em}.hide_answer.mdl-button.mdl-js-button{display:none;!important}body,h1,h2,h3,h4,h5,h6,p,blockquote,pre,hr,dl,dd,ol,ul,figure{margin:0;padding:0}body{font-family:Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5;font-weight:300;color:#111;background-color:yellow;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,p,blockquote,pre,ul,ol,dl,figure,.highlight{margin-bottom:15px}img{max-width:100%;vertical-align:middle;display:block}figure>img{display:block}figcaption{font-size:14px}ul,ol{margin-left:30px}li>ul,li>ol{margin-bottom:0}h1,h2,h3,h4,h5,h6{font-weight:300}a{color:#2a7ae2;text-decoration:none}a:visited{color:#1756a9}a:hover{color:#111;text-decoration:underline}blockquote{color:#828282;border-left:4px solid #e8e8e8;padding-left:15px;font-size:18px;letter-spacing:-1px;font-style:italic}blockquote>:last-child{margin-bottom:0}pre,code{font-size:15px;border:1px solid #e8e8e8;border-radius:3px;background-color:#eef}code{padding:1px 5px}pre{padding:8px 12px;overflow-x:scroll}pre>code{border:0;padding-right:0;padding-left:0}.wrapper{max-width:-webkit-calc(800px -(30px * 2));max-width:calc(800px -(30px * 2));margin-right:auto;margin-left:auto;padding-right:30px;padding-left:30px}@media screen and (max-width:800px){.wrapper{max-width:-webkit-calc(800px -(30px));max-width:calc(800px -(30px));padding-right:15px;padding-left:15px}}.wrapper:after,.footer-col-wrapper:after{content:"";display:table;clear:both}.icon>svg{display:inline-block;width:16px;height:16px;vertical-align:middle}.icon>svg path{fill:#828282}.site-header{border-top:5px solid #424242;border-bottom:1px solid #e8e8e8;min-height:56px;position:relative}.site-title{font-size:26px;line-height:56px;letter-spacing:-1px;margin-bottom:0;float:left}.site-title,.site-title:visited{color:#424242}.sidebar-nav{float:left;border-right:1px solid #e8e8e8}.site-nav{float:right;line-height:56px}.site-nav .menu-icon{display:none}.site-nav .page-link{color:#111;line-height:1.5}.site-nav .page-link:not(:first-child){margin-left:20px}@media screen and (max-width:600px){.site-nav{position:absolute;top:9px;right:30px;background-color:yellow;border:1px solid #e8e8e8;border-radius:5px;text-align:right}.site-nav .menu-icon{display:block;float:right;width:36px;height:26px;line-height:0;padding-top:10px;text-align:center}.site-nav .menu-icon>svg{width:18px;height:15px}.site-nav .menu-icon>svg path{fill:#424242}.site-nav .trigger{clear:both;display:none}.site-nav:hover .trigger{display:block;padding-bottom:5px}.site-nav .page-link{display:block;padding:5px 10px}}.site-footer{border-top:1px solid #e8e8e8;padding:30px 0}.footer-heading{font-size:18px;margin-bottom:15px}.contact-list,.social-media-list{list-style:none;margin-left:0}.footer-col-wrapper{font-size:15px;color:#828282;margin-left:-15px}.footer-col{float:left;margin-bottom:15px;padding-left:15px}.footer-col-1{width:-webkit-calc(35% -(30px / 2));width:calc(35% -(30px / 2))}.footer-col-2{width:-webkit-calc(20% -(30px / 2));width:calc(20% -(30px / 2))}.footer-col-3{width:-webkit-calc(45% -(30px / 2));width:calc(45% -(30px / 2))}@media screen and (max-width:800px){.footer-col-1,.footer-col-2{width:-webkit-calc(50% -(30px / 2));width:calc(50% -(30px / 2))}.footer-col-3{width:-webkit-calc(100% -(30px / 2));width:calc(100% -(30px / 2))}}@media screen and (max-width:600px){.footer-col{float:none;width:-webkit-calc(100% -(30px / 2));width:calc(100% -(30px / 2))}}.page-content{padding:30px 0}.page-heading{font-size:20px}.post-list{margin-left:0;list-style:none;display:block;flex-wrap:wrap;justify-content:flex-start}.post-list>li{flex-basis:50%}.post-meta{font-size:14px;color:#828282}.post-link{display:block;font-size:1em}.post-header,.post-footer{margin-bottom:30px}.cssi-post-title{font-size:42px;letter-spacing:-1px;line-height:1}@media screen and (max-width:800px){.cssi-post-title{font-size:36px}}.cssix-intro h1{font-size:24px;line-height:1}.cssix-intro h2{font-size:16px;line-height:1}.post-content{margin-bottom:30px}.post-content h2{font-size:32px}@media screen and (max-width:800px){.post-content h2{font-size:28px}}.post-content h3{font-size:26px}@media screen and (max-width:800px){.post-content h3{font-size:22px}}.post-content h4{font-size:20px}@media screen and (max-width:800px){.post-content h4{font-size:18px}}.PageNavigation{font-size:14px;display:block;width:auto;overflow:hidden}.PageNavigation a{display:block;width:50%;float:left;margin:1em 0}.PageNavigation .next{text-align:right}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:#008080}.highlight .nb{color:#0086B3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:#008080}.highlight .ni{color:#800080}.highlight .ne{color:#900;font-weight:bold}.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:#008080}.highlight .vg{color:#008080}.highlight .vi{color:#008080}.highlight .il{color:#099}</style><link href="http://cssicurriculum.withgoogle.com/mvc-appEngine/templating.html" rel="canonical"><link href="http://cssicurriculum.withgoogle.com/feed.xml" rel="alternate" title="Google CSSI" type="application/rss+xml"></head><body class="mdl-color--grey-100 mdl-color-text--grey-700 mdl-cssix" data-gr-c-s-loaded="true"><div class="mdl-layout__container has-scrolling-header"><div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--no-desktop-drawer-button has-drawer is-small-screen has-tabs is-upgraded" data-upgraded=",MaterialLayout"><header class="mdl-layout__header mdl-layout__header--scroll mdl-color--primary mdl-color-text--white"><div aria-expanded="false" role="button" tabindex="0" class="mdl-layout__drawer-button"><i class="material-icons"></i></div><div class="mdl-layout--large-screen-only mdl-layout__header-row"></div><div class="mdl-layout__header-row"><a href="https://cssicurriculum.withgoogle.com/" id="cssilogo_header"></a></div><div class="mdl-layout--large-screen-only mdl-layout__header-row"></div><div class="mdl-layout__tab-bar-container"><div class="mdl-layout__tab-bar-button mdl-layout__tab-bar-left-button"><i class="material-icons">chevron_left</i></div><div class="mdl-layout--large-screen-only mdl-layout__tab-bar mdl-js-ripple-effect mdl-color--primary-dark mdl-color-text--white mdl-js-ripple-effect--ignore-events" data-upgraded=",MaterialRipple"><a class="mdl-layout__tab" href="https://cssicurriculum.withgoogle.com/intro.html">Intro<span class="mdl-layout__tab-ripple-container mdl-js-ripple-effect" data-upgraded=",MaterialRipple"><span class="mdl-ripple"></span></span></a><a class="mdl-layout__tab" href="https://cssicurriculum.withgoogle.com/command-line.html">Command Line<span class="mdl-layout__tab-ripple-container mdl-js-ripple-effect" data-upgraded=",MaterialRipple"><span class="mdl-ripple"></span></span></a><a class="mdl-layout__tab" href="https://cssicurriculum.withgoogle.com/html.html">HTML &amp; CSS<span class="mdl-layout__tab-ripple-container mdl-js-ripple-effect" data-upgraded=",MaterialRipple"><span class="mdl-ripple"></span></span></a><a class="mdl-layout__tab" href="https://cssicurriculum.withgoogle.com/javascript.html">JavaScript<span class="mdl-layout__tab-ripple-container mdl-js-ripple-effect" data-upgraded=",MaterialRipple"><span class="mdl-ripple"></span></span></a><a class="mdl-layout__tab" href="https://cssicurriculum.withgoogle.com/python.html">Python<span class="mdl-layout__tab-ripple-container mdl-js-ripple-effect" data-upgraded=",MaterialRipple"><span class="mdl-ripple"></span></span></a><a class="mdl-layout__tab is-active" href="https://cssicurriculum.withgoogle.com/app-engine.html">AppEngine<span class="mdl-layout__tab-ripple-container mdl-js-ripple-effect" data-upgraded=",MaterialRipple"><span class="mdl-ripple"></span></span></a><a class="mdl-layout__tab" href="https://cssicurriculum.withgoogle.com/project.html">Project Week<span class="mdl-layout__tab-ripple-container mdl-js-ripple-effect" data-upgraded=",MaterialRipple"><span class="mdl-ripple"></span></span></a><a class="mdl-layout__tab" href="https://cssicurriculum.withgoogle.com/git.html">Git<span class="mdl-layout__tab-ripple-container mdl-js-ripple-effect" data-upgraded=",MaterialRipple"><span class="mdl-ripple"></span></span></a><a class="mdl-layout__tab" href="https://cssicurriculum.withgoogle.com/resources.html">Resources<span class="mdl-layout__tab-ripple-container mdl-js-ripple-effect" data-upgraded=",MaterialRipple"><span class="mdl-ripple"></span></span></a></div><div class="mdl-layout__tab-bar-button mdl-layout__tab-bar-right-button"><i class="material-icons">chevron_right</i></div></div></header><div class="mdl-layout__drawer" aria-hidden="true"><span class="mdl-layout-title">CSSIx Modules</span><nav class="mdl-navigation"><a class="mdl-navigation__link" href="https://cssicurriculum.withgoogle.com/intro.html">Intro</a> <a class="mdl-navigation__link" href="https://cssicurriculum.withgoogle.com/command-line.html">Command Line</a> <a class="mdl-navigation__link" href="https://cssicurriculum.withgoogle.com/html.html">HTML &amp; CSS</a> <a class="mdl-navigation__link" href="https://cssicurriculum.withgoogle.com/javascript.html">JavaScript</a> <a class="mdl-navigation__link" href="https://cssicurriculum.withgoogle.com/python.html">Python</a> <a class="mdl-navigation__link is-active" href="https://cssicurriculum.withgoogle.com/app-engine.html">AppEngine</a> <a class="mdl-navigation__link" href="https://cssicurriculum.withgoogle.com/project.html">Project Week</a> <a class="mdl-navigation__link" href="https://cssicurriculum.withgoogle.com/git.html">Git</a> <a class="mdl-navigation__link" href="https://cssicurriculum.withgoogle.com/resources.html">Resources</a></nav></div><main class="mdl-layout__content cssi-main"><div class="mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div><div class="cssix-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><div class="post"><header class="post-header"><div><div class="PageNavigation"><a class="prev" href="https://cssicurriculum.withgoogle.com/mvc-appEngine/appEngine-setup.html">« Getting Started With AppEngine Lecture Guide</a> <a class="next" href="https://cssicurriculum.withgoogle.com/mvc-appEngine/appengine-quiz.html">AppEngine Quiz »</a></div></div></header><article class="post-content"><h1 id="jinja-templates-lecture-guide">Jinja Templates Lecture Guide</h1><h2 id="framing">Framing</h2><h3 id="context--purpose">Context &amp; purpose</h3><p>In order to create a web application, we will need to make our app pages dynamic. GAE often uses the Jinja2 templating library to allow us to create webpages with a few missing pieces that our app can fill in with information unique to each user, often based on the information they provide.</p><h3 id="learning-objectives">Learning objectives</h3><ul><li>Understand how templates differ from static HTML pages</li><li>Point the controller to the template’s correct file path</li><li>Pass template variables from the controller to the view</li></ul><h3 id="sequence">Sequence</h3><ol><li><a href="https://cssicurriculum.withgoogle.com/mvc-appEngine/templating.html#introduction-to-templates">Introduction to Templates</a></li><li><a href="https://cssicurriculum.withgoogle.com/mvc-appEngine/templating.html#rendering-templates-in-gae">Rendering Templates in GAE</a></li><li><a href="https://cssicurriculum.withgoogle.com/mvc-appEngine/templating.html#passing-template-variables">Passing Template Variables</a></li></ol><h2 id="introduction-to-templates">Introduction to Templates</h2><p>In this section we just need to make sure that we can point the controller to the correct template, and add Jinja to our yaml file.</p><h5 id="create-a-template">Create A Template</h5><p>Create a <code class="highlighter-rouge">welcome.html</code> for the meme generator. Make sure it includes at least the following:</p><ul><li>Two headers of different sizes</li><li>One image</li><li>Some welcome text (ie: “Welcome to Chicago’s Best Meme Generator”)</li></ul><p>Once that’s done, create a new directory called <code class="highlighter-rouge">templates</code> where your <code class="highlighter-rouge">welcome.html</code> file can be stored - if you remember our separation of concerns, you can figure out why having a separate directory/folder for all our templates would be important.</p><p>If you’re a bit rusty on your HTML, click to see an example of a barebones HTML page.</p><div class="answer_container"><div class="answer"><div></div><p></p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Welcome<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Meme Generator<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">height=</span><span class="s">"100px"</span> <span class="na">width=</span><span class="s">"150px"</span>
    <span class="na">src=</span><span class="s">"https://www.publicdomainpictures.net/pictures/90000/velka/alpaca-chewing.jpg"</span>
    <span class="na">alt=</span><span class="s">"a-chewing-alpaca"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h2&gt;</span>Welcome to my Meme Generator!<span class="nt">&lt;/h2&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div><p></p></div><button class="show_answer mdl-button mdl-js-button mdl-button--primary" value="Show" data-upgraded=",MaterialButton">Show</button><button class="hide_answer mdl-button mdl-js-button mdl-button--accent" value="Hide" data-upgraded=",MaterialButton">Hide</button></div><p></p><p>This isn’t quite a template yet, since there are no dynamic pieces, but before we add that piece, it’s important to confirm this HTML renders as expected. Open it in your browser and confirm that it works.</p><h5 id="adding-jinja2">Adding Jinja2</h5><p>The only difference between a template and a static HTML file is that a template can be completed at the time it’s requested. To put it another way, a template is the reason each person’s page on any given social media site looks more-or-less the same as every other user’s page on that same site. There are fill-in-the-blank pieces of information being added when you load a page up, but the core structure of the page is reusable across thousands or even millions of users. This means we only need to make one template instead of thousands or millions of HTML files.</p><p>In order to use the templating library Jinja2, we’re going to need to load up the library in each of our two main GAE files: <code class="highlighter-rouge">app.yaml</code> and <code class="highlighter-rouge">main.py</code>.</p><p>We’re adding a new section underneath our handlers. Remember that this configuration file is very whitespace sensitive, so make sure you aren’t adding extra spaces as you go.</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="c1">#app.yaml</span>
<span class="na">runtime</span><span class="pi">:</span> <span class="s">python27</span>
<span class="na">api_version</span><span class="pi">:</span> <span class="s">1</span>
<span class="na">threadsafe</span><span class="pi">:</span> <span class="no">true</span>

<span class="na">handlers</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">url</span><span class="pi">:</span> <span class="s">/.*</span>
  <span class="na">script</span><span class="pi">:</span> <span class="s">main.app</span>

<span class="na">libraries</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">jinja2</span>
  <span class="na">version</span><span class="pi">:</span> <span class="s">latest</span>

</pre></td></tr></tbody></table></code></pre></div></div><p>Now that jinja2 can be accessed by the app, it needs to be added to <code class="highlighter-rouge">main.py</code></p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c">#main.py</span>
<span class="c">#the import section</span>
<span class="kn">import</span> <span class="nn">webapp2</span>
<span class="kn">import</span> <span class="nn">jinja2</span>
</pre></td></tr></tbody></table></code></pre></div></div><h5 id="rendering-templates-in-gae">Rendering Templates in GAE</h5><p>We’re almost ready to start using templates, but before we do, the Jinja environment variable needs to be set in order to understand where in the file path to start looking for the templates.</p><p>To avoid typos, this variable can (and probably should) be copy-pasted from <a href="https://cloud.google.com/appengine/docs/standard/python/getting-started/generating-dynamic-content-templates">the documentation</a>.</p><p>Here’s where and how we include this setup in our code - this example includes a few modified variable names to more precisely refer to the content we’re using in our site:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="c"># main.py</span>
<span class="c"># the import section</span>
<span class="kn">import</span> <span class="nn">webapp2</span>
<span class="kn">import</span> <span class="nn">jinja2</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c"># This initializes the jinja2 Environment.</span>
<span class="c"># This will be the same in every app that uses the jinja2 templating library.</span>
<span class="n">the_jinja_env</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span>
    <span class="n">loader</span><span class="o">=</span><span class="n">jinja2</span><span class="o">.</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)),</span>
    <span class="n">extensions</span><span class="o">=</span><span class="p">[</span><span class="s">'jinja2.ext.autoescape'</span><span class="p">],</span>
    <span class="n">autoescape</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># the handler section</span>
<span class="k">class</span> <span class="nc">EnterInfoHandler</span><span class="p">(</span><span class="n">webapp2</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c"># for a get request</span>
        <span class="n">welcome_template</span> <span class="o">=</span> <span class="n">the_jinja_env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s">'templates/welcome.html'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">welcome_template</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>  <span class="c"># the response</span>
<span class="c"># etc</span>
</pre></td></tr></tbody></table></code></pre></div></div><p></p><h4 id="mini-challenge">Mini-challenge</h4><p>Using the EnterInfoHandler and <code class="highlighter-rouge">welcome.html</code> template as an example, design and render a <code class="highlighter-rouge">results.html</code> template which includes at least:</p><ul><li>One header</li><li>A background image for a meme</li><li>Your meme text (this doesn’t have to be user generated; you can use placeholder text like “Your meme goes here” until we’re ready to replace it).</li></ul><p><em>NOTE</em>: For now, if you find yourself ready to add some CSS, go ahead and add it between <code class="highlighter-rouge">&lt;style&gt;</code> tags included in the document’s <code class="highlighter-rouge">&lt;head&gt;</code> element. Eventually, we’re separate these concerns too, but we aren’t ready to link separate CSS files just yet.</p><p></p><p>Click below to see an example of our second template.</p><div class="answer_container"><div class="answer"><div></div><p></p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>A Meme<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;style&gt;</span>
      <span class="nf">#meme-div</span><span class="p">{</span>
      <span class="nl">width</span><span class="p">:</span> <span class="m">450px</span><span class="p">;</span>
      <span class="nl">height</span><span class="p">:</span> <span class="m">450px</span><span class="p">;</span>
      <span class="nl">background-size</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
      <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
      <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">h2</span> <span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
        <span class="nl">left</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="nl">right</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="nl">margin</span><span class="p">:</span> <span class="m">15px</span> <span class="m">0</span><span class="p">;</span>
        <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span> <span class="m">5px</span><span class="p">;</span>
        <span class="nl">font-family</span><span class="p">:</span> <span class="n">impact</span><span class="p">;</span>
        <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
        <span class="nl">text-shadow</span><span class="p">:</span> <span class="m">1px</span> <span class="m">1px</span> <span class="no">black</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nf">#line1</span> <span class="p">{</span>
         <span class="nl">top</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
       <span class="p">}</span>
      <span class="nf">#line2</span> <span class="p">{</span>
         <span class="nl">bottom</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
       <span class="p">}</span>
    <span class="nt">&lt;/style&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Your Meme<span class="nt">&lt;/h1&gt;</span>
    <span class="c">&lt;!--The image needs to be rendered for each new meme
    so set the div's background-image property inline --&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"meme-div"</span>
    <span class="na">style=</span><span class="s">"background-image:url(https://upload.wikimedia.org/wikipedia/commons/f/ff/Deep_in_thought.jpg);"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"line1"</span><span class="nt">&gt;</span>Why is it that humans bake cookies?<span class="nt">&lt;/h2&gt;</span>
      <span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"line2"</span><span class="nt">&gt;</span>Yet cook bacon?<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div><p></p></div><button class="show_answer mdl-button mdl-js-button mdl-button--primary" value="Show" data-upgraded=",MaterialButton">Show</button><button class="hide_answer mdl-button mdl-js-button mdl-button--accent" value="Hide" data-upgraded=",MaterialButton">Hide</button></div><p></p><p>Click below to see an example of how we set up the <code class="highlighter-rouge">main.py</code> file to render the new template.</p><div class="answer_container"><div class="answer"><div></div><p></p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">webapp2</span>
<span class="kn">import</span> <span class="nn">jinja2</span>
<span class="kn">import</span> <span class="nn">os</span>


<span class="n">the_jinja_env</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span>
    <span class="n">loader</span><span class="o">=</span><span class="n">jinja2</span><span class="o">.</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)),</span>
    <span class="n">extensions</span><span class="o">=</span><span class="p">[</span><span class="s">'jinja2.ext.autoescape'</span><span class="p">],</span>
    <span class="n">autoescape</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="c"># the handler section</span>
<span class="k">class</span> <span class="nc">EnterInfoHandler</span><span class="p">(</span><span class="n">webapp2</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c"># for a get request</span>
        <span class="n">welcome_template</span> <span class="o">=</span> <span class="n">the_jinja_env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s">'templates/welcome.html'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">welcome_template</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>


<span class="k">class</span> <span class="nc">ShowMemeHandler</span><span class="p">(</span><span class="n">webapp2</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">results_template</span> <span class="o">=</span> <span class="n">the_jinja_env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s">'templates/results.html'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">results_template</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>  <span class="c"># the response</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">webapp2</span><span class="o">.</span><span class="n">WSGIApplication</span><span class="p">([</span>
    <span class="p">(</span><span class="s">'/'</span><span class="p">,</span> <span class="n">EnterInfoHandler</span><span class="p">),</span>
    <span class="p">(</span><span class="s">'/memeresult'</span><span class="p">,</span> <span class="n">ShowMemeHandler</span><span class="p">)</span>
<span class="p">],</span> <span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div><p></p></div><button class="show_answer mdl-button mdl-js-button mdl-button--primary" value="Show" data-upgraded=",MaterialButton">Show</button><button class="hide_answer mdl-button mdl-js-button mdl-button--accent" value="Hide" data-upgraded=",MaterialButton">Hide</button></div><p></p><h3 id="dynamic-templates">Dynamic Templates</h3><p>We’ve already talked about how Jinja2 allows us to “fill in the blank” with data not included in the original templates. But right now our templates don’t really have any blanks, so we’ll need to include placeholders for “fill in the blank” data with double curly braces (sometimes called “moustache brackets”): <code class="highlighter-rouge">{{YOUR_VARIABLE_HERE}}</code>.</p><p>For our meme, we’ll create a page with all the HTML, and just a few missing pieces of data:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Your Meme<span class="nt">&lt;/h1&gt;</span>
    <span class="c">&lt;!--The image needs to be rendered for each new meme
    so set the div's background-image property inline --&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"meme-div"</span> <span class="na">style=</span><span class="s">"background-image:url( {{img_url}});"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"line1"</span><span class="nt">&gt;</span> {{line1}}<span class="nt">&lt;/h2&gt;</span>
      <span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"line2"</span><span class="nt">&gt;</span> {{line2}}<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>

</pre></td></tr></tbody></table></code></pre></div></div><h3 id="passing-template-variables">Passing Template Variables</h3><p>You will want a refresher on dictionaries in order for this next bit to stick, so these mini-challenges should do the trick.</p><h6 id="mini-challenges">Mini-challenges:</h6><ul><li>Construct a Python dictionary of certain attributes that might be passed in a recipe app (or any type of app). For example, we used attributes like “cuisine” and “cook-time”.</li><li>Access each of the key-value pairs to confirm that your dictionary works.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">recipe_dic</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"cuisine"</span><span class="p">:</span> <span class="s">"Mexican"</span><span class="p">,</span>
    <span class="s">"serving-size"</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s">"cook-time-mins"</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="s">"recipe-name"</span><span class="p">:</span> <span class="s">"Enchiladas"</span><span class="p">,</span>
    <span class="s">"ingredients"</span><span class="p">:</span> <span class="p">[</span><span class="s">"Chicken"</span><span class="p">,</span> <span class="s">"Red Onions"</span><span class="p">,</span> <span class="s">"Cilantro"</span><span class="p">,</span> <span class="s">"Green Chiles"</span><span class="p">]</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div><h4 id="creating-a-template-dictionary">Creating a Template Dictionary</h4><p>In order for the controller to pass data to the view to be rendered as part of a template, that data needs to be organized in a Python dictionary.</p><p>The <strong>key</strong> names should correspond to the variables used in the template - the template above used <code class="highlighter-rouge">line1</code>, <code class="highlighter-rouge">line2</code>, and <code class="highlighter-rouge">img_url</code>, so this dictionary (<code class="highlighter-rouge">the_variable_dict</code>) uses those names as keys:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">ShowMemeHandler</span><span class="p">(</span><span class="n">webapp2</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">results_template</span> <span class="o">=</span> <span class="n">the_jinja_env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s">'templates/results.html'</span><span class="p">)</span>
        <span class="n">the_variable_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"line1"</span><span class="p">:</span> <span class="s">"If Cinderella's shoe was a perfect fit"</span><span class="p">,</span>
            <span class="s">"line2"</span><span class="p">:</span> <span class="s">"Why did it fall off?"</span><span class="p">,</span>
            <span class="s">"img_url"</span><span class="p">:</span> <span class="s">"https://upload.wikimedia.org/wikipedia/commons/f/ff/Deep_in_thought.jpg"</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">results_template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">the_variable_dict</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Keeping the names of the variables and keys straight is one of the hardest parts of this process. The template should have the KEY names within the curly/moustache brackets. When the template gets rendered, the key’s VALUE will appear in the HTML output.</p><p></p><h4 id="mini-challenge-1">Mini-challenge</h4><ul><li>Using the previous handler and the <code class="highlighter-rouge">results.html</code> template as an example, create a template variable dictionary to pass to the welcome page. The dictionary should include a greeting and an adjective.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">EnterInfoHandler</span><span class="p">(</span><span class="n">webapp2</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c"># for a get request</span>
        <span class="n">welcome_template</span> <span class="o">=</span> <span class="n">the_jinja_env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s">'templates/welcome.html'</span><span class="p">)</span>
        <span class="n">a_variable_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"greeting"</span><span class="p">:</span> <span class="s">"Howdy"</span><span class="p">,</span>
            <span class="s">"adjective"</span><span class="p">:</span> <span class="s">"amazing"</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">welcome_template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">a_variable_dict</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Right now, we’re creating dynamic pages, but those pieces of information are still hard-coded into our <code class="highlighter-rouge">main.py</code> file. In the next lesson, we will learn how to grab <em>user</em> data from html form and process it using POST requests.</p><p></p></article><footer class="post-footer"><hr><div class="PageNavigation"><a class="prev" href="https://cssicurriculum.withgoogle.com/mvc-appEngine/appEngine-setup.html">« Getting Started With AppEngine Lecture Guide</a> <a class="next" href="https://cssicurriculum.withgoogle.com/mvc-appEngine/appengine-quiz.html">AppEngine Quiz »</a></div></footer></div></div></div></main><footer class="mdl-mini-footer section"><div class="mdl-mini-footer__left-section"><div class="lockup va"><span class="lockup-logo lockup-dark"></span></div></div><div class="mdl-mini-footer__right-section"><ul class="mdl-mini-footer__link-list"><li><span id="site_label">CSSI - Atlanta</span></li><li>--</li><li><a href="https://www.google.com/intl/en/about/">About Google</a></li><li><a href="https://www.google.com/intl/en/policies/privacy/">Privacy</a></li><li><a href="https://www.google.com/intl/en/policies/terms/">Terms</a></li><li><a href="https://cssicurriculum.withgoogle.com/mvc-appEngine/templating.html#" id="signout_link">Logout</a></li><li><a href="https://cssicurriculum.withgoogle.com/mvc-appEngine/templating.html#" id="forgetme_link">Forget Me</a></li></ul></div><script src="./Jinja Templates Lecture Guide_files/firebase-app.js.download"></script><script src="./Jinja Templates Lecture Guide_files/firebase-auth.js.download"></script><script src="./Jinja Templates Lecture Guide_files/firebaseui.js.download"></script><link href="./Jinja Templates Lecture Guide_files/firebaseui.css" rel="stylesheet" type="text/css"><script>
  function getCookie(name) {
    let dc = document.cookie;
    let prefix = name + "=";
    let begin = dc.indexOf("; " + prefix);
    if (begin == -1) {
      begin = dc.indexOf(prefix);
      if (begin != 0) return null;
    }
    begin += 2;
    let end = document.cookie.indexOf(";", begin);
    if (end == -1) {
      end = dc.length;
    }
    return decodeURI(dc.substring(begin + prefix.length, end));
  }

  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyD_NpvZGlms1zebBgfE4RZPCim5irYGbG4",
    authDomain: "cssi-curriculum.firebaseapp.com",
    databaseURL: "https://cssi-curriculum.firebaseio.com",
    projectId: "cssi-curriculum",
    storageBucket: "cssi-curriculum.appspot.com",
    messagingSenderId: "443846997353"
  };
  // Firebase log-in widget
  function configureFirebaseLoginWidget() {
    let uiConfig = {
      signInSuccessUrl: '/',
      signInOptions: [
        // Leave the lines as is for the providers you want to offer your users.
        firebase.auth.GoogleAuthProvider.PROVIDER_ID,
        {
            provider: firebase.auth.EmailAuthProvider.PROVIDER_ID,
            // Whether the display name should be displayed in the Sign Up page.
            requireDisplayName: false,
        },
      ],
      callbacks: {
        signInSuccessWithAuthResult: function(authResult, redirectUrl) {
          let user = authResult.user;
          let credential = authResult.credential;
          let isNewUser = authResult.additionalUserInfo.isNewUser;
          let providerId = authResult.additionalUserInfo.providerId;
          let operationType = authResult.operationType;
          // Do something with the returned AuthResult.
          // Return type determines whether we continue the redirect automatically
          // or whether we leave that to developer to handle.
          return true;
        },
        signInFailure: function(error) {
          // Some unrecoverable error occurred during sign-in.
          // Return a promise when error handling is completed and FirebaseUI
          // will reset, clearing any UI. This commonly occurs for error code
          // 'firebaseui/anonymous-upgrade-merge-conflict' when merge conflict
          // occurs. Check below for more details on this.
          return handleUIError(error);
        },
      },
      // Terms of service url
      'tosUrl': 'https://www.google.com/intl/en/policies/terms/',
    };

    let user = firebase.auth().currentUser;
    if (!user && document.getElementById('firebaseui-auth-container')) {
      let ui = new firebaseui.auth.AuthUI(firebase.auth());
      ui.start('#firebaseui-auth-container', uiConfig);
    }
  }

  function updateUserToken(user) {
    let oldCookie = getCookie('idToken');
    if (user) {
      let refresh_token = getCookie('needRefreshToken');
      user.getIdToken(refresh_token == 'true').then(function(idToken) {
        document.cookie = "idToken=" + idToken + "; path=/";
        if (!oldCookie) {
          location.reload();
        }
      });
    } else {
      console.log("Removing auth token");
      document.cookie = "idToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC";
      if (oldCookie) {
        location.reload();
      }
    }
  }

  function configureFirebaseLogin() {
    firebase.initializeApp(config);
    firebase.auth().onAuthStateChanged(updateUserToken);
    firebase.auth().onIdTokenChanged(function() {console.log("token changed");});
  }

  function signOut() {
    firebase.auth().signOut();
    window.location = "/";
    return false;
  }

  function forgetMe() {
    let user = firebase.auth().currentUser;
    user.delete().then(function() {
      console.log("User deleted");
    }).catch(function(error) {
      console.log("Error deleting the user " + error);
    });
    firebase.auth().signOut();
    window.location = "/";
    return false;
  }

  function sendVerificationEmail() {
    let user = firebase.auth().currentUser;
    if (user && !user.emailVerified) {
      user.sendEmailVerification().then(function() {
          console.log("Verification email sent.");
        }).catch(function(error) {
          console.log("An error happened while sending the verification email.");
        });
    } else if (user) {
      console.log("Email already verified");
    } else {
      console.log("User not logged in");
    }
    console.log("Removing auth token");
    document.cookie = "idToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC";
    document.querySelector('#send_verification_button').style.display = 'None';
    document.querySelector('#verification_sent').style.display = 'block';
  }

  function checkAndRestoreCookie(){
    let user = firebase.auth().currentUser;
  }

  function showAnswer(event) {
    let show_answer_button = event.currentTarget;
    let answer_container = show_answer_button.parentElement;
    toggleAnswer(answer_container, true);
  }

  function hideAnswer(event) {
    let show_answer_button = event.currentTarget;
    let answer_container = show_answer_button.parentElement;
    toggleAnswer(answer_container, false);
  }

  function toggleAnswer(container, visible) {
    let answer = container.querySelector('.answer');
    answer.style.display = visible ? 'block' : 'none';
    let hide_answer_button = container.querySelector('.hide_answer');
    hide_answer_button.style.display = visible ? 'block' : 'none';
    let show_answer_button = container.querySelector('.show_answer');
    show_answer_button.style.display = visible ? 'none' : 'block';
  }

  function toggleStudentViewCookie(event) {
    const new_value = event.target.checked;
    document.cookie = "student_view=" + new_value + ";path=/";
    location.reload();
  }

  window.addEventListener('load', function() {
    configureFirebaseLogin();
    configureFirebaseLoginWidget();
    //checkAndRestoreCookie();
    let signout_link = document.querySelector('#signout_link');
    if (signout_link) {
      signout_link.onclick = signOut;
    }
    let forgetme_link = document.querySelector('#forgetme_link');
    if (forgetme_link) {
      forgetme_link.onclick = forgetMe;
    }
    let email_verification_btn = document.querySelector('#send_verification_button');
    if (email_verification_btn) {
      email_verification_btn.onclick = sendVerificationEmail;
    }
    let show_answer_btns = document.querySelectorAll('.show_answer');
    show_answer_btns.forEach( function(element) {
      element.onclick = showAnswer;
    });
    let hide_answer_btns = document.querySelectorAll('.hide_answer');
    hide_answer_btns.forEach( function(element) {
      element.onclick = hideAnswer;
    });
    // Student View checkbox not available on all pages, if present,
    // it can be used to override the user role, so that instructors can view
    // content as students.
    let student_view_flag = document.querySelector('#chk_student_view');
    if (student_view_flag) {
      student_view_flag.checked = JSON.parse(getCookie('student_view'));
      student_view_flag.onclick = toggleStudentViewCookie;
    }
    // Select the proper element in the site selection view based on the
    // existing cookies.
    let selected_site = getCookie('site');
    let site_selector_list = document.querySelectorAll('.site_radio');
    [].forEach.call(site_selector_list, (element) => {
      element.addEventListener('click', () => {
        console.log('Clicked ' + element.value);
        document.cookie = "site=" + element.value + ";path=/";
        document.querySelector('#site_label').innerText = element.dataset.label;
      });
    });
    if (selected_site && site_selector_list.length > 0) {
      [].forEach.call(site_selector_list, (element) => {
        console.log(selected_site);
        if (element.value === selected_site) {
          element.checked = true;
        } else {
          element.checked = false;
        }
      });
      console.log(site_selector_list);
    }

  })
</script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-101261509-1', 'auto');
  ga('send', 'pageview');
</script></footer><div class="mdl-layout__obfuscator"></div></div></div></body></html>